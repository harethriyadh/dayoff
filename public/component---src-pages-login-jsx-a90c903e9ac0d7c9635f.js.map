{"version":3,"file":"component---src-pages-login-jsx-a90c903e9ac0d7c9635f.js","mappings":"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","sources":["webpack://my-app/./src/pages/login.jsx"],"sourcesContent":["import { Link } from 'gatsby'; // Import the Link component from Gatsby\nimport React, { useState, useEffect } from 'react';\nimport '../styles/css/tabler.min.css'; // Removed - causing errors\nimport '../styles/css/tabler-flags.min.css'; // Removed - causing errors\nimport '../styles/css/tabler-socials.min.css'; // Removed - causing errors\nimport '../styles/css/tabler-payments.min.css'; // Removed - causing errors\nimport '../styles/css/tabler-vendors.min.css'; // Removed - causing errors\nimport '../styles/css/tabler-marketing.min.css'; // Removed - causing errors\nimport '../styles/css/demo.min.css'; // Removed - causing errors\nimport '../styles/rtl.css'; // Removed - causing errors\n\n\nfunction LoginPage() {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [passwordVisible, setPasswordVisible] = useState(false);\n  const [rememberMe, setRememberMe] = useState(false);\n  const [message, setMessage] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    const checkSession = async () => {\n      try {\n        const response = await fetch('https://subend.onrender.com/api/login');\n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n\n        if (response.ok && data.user) {\n          window.location.href = \"/index\";\n        } else {\n          setMessage('Please log in.');\n        }\n      } catch (error) {\n        console.error('Error checking session:', error);\n        setMessage('Failed to check session. Server error: ' + error.message); // Include the error message\n        setLoading(false); // Make sure to set loading to false on error\n      }\n    };\n    checkSession();\n  }, []);\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    setMessage('');\n    setLoading(true);\n\n    if (!username || !password) {\n      setMessage('Please enter both username and password.');\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const response = await fetch('https://subend.onrender.com/api/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ username, password }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Login failed.  Server error.');\n      }\n\n      const data = await response.json();\n\n      if (data.token) {\n        localStorage.setItem('authToken', data.token);\n        if (rememberMe) {\n          localStorage.setItem('rememberMe', 'true');\n          localStorage.setItem('username', username);\n          localStorage.setItem('password', password);\n        } else {\n          localStorage.removeItem('rememberMe');\n          localStorage.removeItem('username');\n          localStorage.removeItem('password');\n        }\n        window.location.href = \"./index\";\n      } else {\n        setMessage(data.message || 'Login failed. Invalid credentials.');\n      }\n    } catch (error) {\n      console.error('Login error:', error);\n      setMessage('Error during login: ' + error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const togglePasswordVisibility = () => {\n    setPasswordVisible(!passwordVisible);\n  };\n\n  const handleRememberMeChange = (e) => {\n    setRememberMe(e.target.checked);\n  };\n\n  return (\n    <div className=\"d-flex flex-column\">\n      <div className=\"page\">\n        <div className=\"container container-tight py-4\">\n          <div className=\"text-center mb-4\">\n            <Link to=\"/\" className=\"navbar-brand navbar-brand-autodark\">\n              {/* Add your logo here if needed */}\n            </Link>\n          </div>\n          <div className=\"card card-md\">\n            <div className=\"card-body\">\n              <h2 className=\"h2 text-center mb-4\">تسجيل الدخول إلى حسابك</h2>\n              <form id=\"loginForm\" onSubmit={handleLogin} autoComplete=\"off\" noValidate>\n                <div className=\"mb-3\">\n                  <label className=\"form-label\">اسم المستخدم</label>\n                  <input\n                    type=\"text\"\n                    id=\"username\"\n                    className=\"form-control\"\n                    placeholder=\"اسم المستخدم\"\n                    autoComplete=\"off\"\n                    value={username}\n                    onChange={(e) => setUsername(e.target.value)}\n                    required\n                  />\n                </div>\n                <div className=\"mb-2 inputfield\">\n                  <label className=\"form-label\">\n                    كلمة المرور\n                    <span className=\"form-label-description\">\n                      <Link to=\"/forgot-password\">نسيت كلمة المرور</Link>\n                    </span>\n                  </label>\n                  <div className=\"input-group input-group-flat\">\n                    <input\n                      type={passwordVisible ? 'text' : 'password'}\n                      id=\"password\"\n                      className=\"form-control password-input\"\n                      placeholder=\"كلمة المرور الخاصة بك\"\n                      autoComplete=\"off\"\n                      value={password}\n                      onChange={(e) => setPassword(e.target.value)}\n                      required\n                    />\n                    <span className=\"input-group-text\">\n                      <a\n                        href=\"javascript:void(0)\" // Or href=\"\"\n                        className=\"link-secondary password-toggle\"\n                        title={passwordVisible ? \"إخفاء كلمة المرور\" : \"إظهار كلمة المرور\"}\n                        onClick={togglePasswordVisibility}\n                      >\n                        <svg\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                          width=\"24\"\n                          height=\"24\"\n                          viewBox=\"0 0 24 24\"\n                          fill=\"none\"\n                          stroke=\"currentColor\"\n                          strokeWidth=\"2\"\n                          strokeLinecap=\"round\"\n                          strokeLinejoin=\"round\"\n                          className=\"icon icon-1\"\n                        >\n                          {passwordVisible ? (\n                            <path d=\"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.56\" />\n                          ) : (\n                            <path d=\"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0\" />\n                          )}\n                          {!passwordVisible && <path d=\"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6\" />}\n                        </svg>\n                      </a>\n                    </span>\n                  </div>\n                </div>\n                <div className=\"mb-2\">\n                  <label className=\"form-check\">\n                    <input\n                      type=\"checkbox\"\n                      className=\"form-check-input\"\n                      id=\"rememberMe\"\n                      checked={rememberMe}\n                      onChange={handleRememberMeChange}\n                    />\n                    <span className=\"form-check-label\">تذكرني على هذا الجهاز</span>\n                  </label>\n                </div>\n                {message && (\n                  <div className=\"alert alert-danger\" role=\"alert\">\n                    <div className=\"d-flex\">\n                      <div>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon alert-icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" strokeWidth=\"2\" stroke=\"currentColor\" fill=\"none\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M3 12a9 9 0 1 0 18 0a9 9 0 0 0-18 0\"></path><path d=\"M12 8v8\"></path><path d=\"M12 16h.01\"></path></svg>\n                      </div>\n                      <div>\n                        <h4 className=\"alert-title\">Error</h4>\n                        <div className=\"alert-text\">\n                          {message}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                )}\n                <div className=\"form-footer\">\n                  <button type=\"submit\" className=\"btn btn-primary w-100\" disabled={loading}>\n                    {loading ? 'جاري التحميل...' : 'تسجيل الدخول'}\n                  </button>\n                </div>\n                <div className=\"text-center text-muted mt-3\">\n                  ليس لديك حساب؟ <Link to=\"/register\">تسجيل الدخول</Link>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default LoginPage;\n"],"names":["username","setUsername","useState","password","setPassword","passwordVisible","setPasswordVisible","rememberMe","setRememberMe","message","setMessage","loading","setLoading","useEffect","async","response","fetch","ok","Error","status","data","json","user","window","location","href","error","console","checkSession","React","className","Link","to","id","onSubmit","e","preventDefault","method","headers","body","JSON","stringify","errorData","token","localStorage","setItem","removeItem","autoComplete","noValidate","type","placeholder","value","onChange","target","required","title","onClick","togglePasswordVisibility","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","checked","role","disabled"],"sourceRoot":""}